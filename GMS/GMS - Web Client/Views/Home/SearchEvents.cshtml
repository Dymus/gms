@model GMS___Web_Client.Models.EventModel

@{
    ViewBag.Title = "SearchEvents";
}

<script src="~/Scripts/jquery-3.5.1.min.js"></script>
<link href="~/Content/css/select2.min.css" rel="stylesheet" />
<script src="~/Scripts/select2.min.js"></script>
<script src="~/JavaScript/search-table-control.js"></script>

<script type="text/javascript">
    function onSearchClick() {
        // Keywords
        var keywords = [];
        var keywordMatching = searchField.value.match(/\S+/g);
        if (keywordMatching != null) {
            for (i = 0; i < keywordMatching.length; i++) {
                keywords.push(keywordMatching[i].toLowerCase());
            }
        }

        // Event types
        var eventTypesSelections = $('#eventTypesSelectBox').select2('data');
        var selections = [];
        for (i = 0; i < eventTypesSelections.length; i++) {
            selections.push(eventTypesSelections[i].text);
        }

        getEvents(selections, keywords);
    }
</script>

<style>
    .mul-select-types, mul-select-roles {
        width: 100%;
    }

    .mul-select-roles {
        width: 100%;
    }

    input.select2-search__field::-webkit-input-placeholder {
        font-weight: bolder;
    }
    /* WebKit, Blink, Edge */
    input.select2-search__field:-moz-placeholder {
        font-weight: bolder;
    }
    /* Mozilla Firefox 4 to 18 */
    input.select2-search__field::-moz-placeholder {
        font-weight: bolder;
    }
    /* Mozilla Firefox 19+ */
    input.select2-search__field:-ms-input-placeholder {
        font-weight: bolder;
    }
    /* Internet Explorer 10-11 */
    input.select2-search__field::-ms-input-placeholder {
        font-weight: bolder;
    }
    /* Microsoft Edge */
</style>

<h2>Search Events</h2>
<br />
<div class="form-row" style="width:60%">
    <div class="col input-group">
        <input id="searchField" type="text" class="form-control" placeholder="Input search keyword" />
        <div class="input-group-append">
            <input id="submitButton" type="submit" class="btn btn-outline-secondary" value="Search" onclick="onSearchClick()" />
        </div>
    </div>
    <div class="col">
        @Html.DropDownListFor(model => model.EventType, Model.EventTypes, new { @class = "mul-select-types", @multiple = "multiple", @id = "eventTypesSelectBox" })
        <!-- TODO Html.DropDownListFor Roles -->
    </div>
</div>

<br />
<div>
    <table id="events-table" class="table table-striped table-hover"></table>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $('.mul-select-types').select2({
            placeholder: "All event types",
            allowClear: true
        });
    });
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $('.mul-select-roles').select2({
            placeholder: "All roles",
            allowClear: true
        });
    });
</script>

<script type="text/javascript">
    $(document).ready(function () {
        getEvents([], []);
    });
</script>

<div>
    @Html.ActionLink("Back to action list", "Index")
</div>

@section Scripts {
    <!-- select2 -->
    @Scripts.Render("~/bundles/select2")
    @Styles.Render("~/Content/css/select2")
    <!-- font-awesome -->
    @Styles.Render("~/Content/css/fontawesome")
}